\section{GaitNet}
\label{sec:results-gaitnet}

The primary objective of GaitNet is to generate fully dynamic and
acyclic gaits for quadruped robots. An example swing sequence is
shown in \autoref{fig:data-swing-schedule}, illustrating a
non-repetitive, dynamic gait in which the robot performs motions with
up to two feet off the ground simultaneously. Swing durations are
non-uniform, with some legs remaining in the swing phase longer than
others. These results demonstrate that the system can synthesize a
wide variety of actions, which are analyzed further below.

Examining \autoref{fig:data-swing-schedule}, a short step is observed
for the front-left leg (green) at 3\,s, while the rear-right leg
(red) executes a longer step at 5\,s. Although the differences in
duration are subtle, they indicate that the system is capable of
dynamically varying step timing.

Another important observation from \autoref{fig:data-swing-schedule}
is the system's response to changing control inputs. Between
0-7.5\,s, the robot is commanded to follow a slow input, and the
system takes a cautious approach, moving one foot at a time. After
7.5\,s, the input speed increases, prompting a more dynamic gait.
During this faster phase, the robot occasionally executes two steps
simultaneously and does not follow a strict alternating pattern,
further highlighting the system's flexibility in generating acyclic gaits.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{images/data/swing-schedule.png}
  \caption{Example swing schedule for a single gait cycle. Each row
  represents a leg, with color indicating the leg is in swing phase.}
  \label{fig:data-swing-schedule}
\end{figure}

To ensure the consistency of the training process, we trained GaitNet
3 times. Due to compute limitations, the 700 step training curriculum
needed to be split into multiple runs. The runs were typically 350
steps long. This has the side-effect of resetting the distribution of
terrain levels, which can cause dis-continuities in certian training metrics.

The mean episode reward during training is shown in
\autoref{fig:data-training-mean-reward}. Each training instance shows a
similar trend, with the reward increasing as the model learns to
navigate the terrain.

Another important metric is the mean steps per second. Initially,
with limited training, the model moves its legs very frequently,
leading to unstable motion. In initial experiments, It was found that
this issue does not resolve well  without guidance from the reward function.
\autoref{sec:appendix-reward-function-analysis} goes into more detail
on this issue, but the results are shown in
\autoref{fig:data-training-steps-per-second}. The mean steps per second
starts high and decreases as the model learns to take more stable steps.

\begin{figure}[H]
  \centering
  \begin{minipage}[t]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/data/training/gaitnet/mean_reward_survival-curr.png}
    \caption{Mean episode reward during GaitNet training. Each is a
    different training instance.}
    \label{fig:data-training-mean-reward}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/data/training/gaitnet/steps_per_second_survival-curr.png}
    \caption{Mean steps per second during GaitNet training. Each is a
    different training instance.}
    \label{fig:data-training-steps-per-second}
  \end{minipage}
  \hfill
\end{figure}

During training, the GaitNet model learns to adjust swing durations
based on its input, as illustrated with
\autoref{fig:data-duration-mean} and \autoref{fig:data-duration-std}.
The mean swing duration settles to 0.24\,s with a standard deviation
of 0.034\,s, indicating that the model uses a wide range of its
allowable swing durations. These figures highlight how the model
learns to effectively utilize dynamic swing durations to adapt to
varying conditions.

\begin{figure}[H]
  \centering
  \begin{minipage}[t]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/data/training/gaitnet/duration_mean_survival-curr.png}
    \caption{Mean swing duration across all environments during
    GaitNet training. Each color is a different training instance.}
    \label{fig:data-duration-mean}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/data/training/gaitnet/duration_std_survival-curr.png}
    \caption{Swing duration standard deviation across all
      environments during GaitNet training. Each color is a different
    training instance.}
    \label{fig:data-duration-std}
  \end{minipage}
  \hfill
\end{figure}

\begin{todo}
  explore a per-leg analysis of swing durations
\end{todo}

\begin{figure}
  \centering
  \begin{minipage}[t]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/data/swing_duration_histogram.png}
    \caption{Histogram of swing durations selected by GaitNet}
    \label{fig:data-swing-duration-histogram}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/data/swing_duration_histogram_easy_vs_hard.png}
    \caption{Comparison of swing durations on easy and hard terrain
    (0\% vs 40\% terrain difficulty).}
    \label{fig:data-swing-duration-histogram-easy-vs-hard}
  \end{minipage}
\end{figure}
